---
title: '书籍'
slug: 'cn/books'
disable_comments: true
---

<link rel="stylesheet" type="text/css" href="/css/star-rating-svg.css">

## 读书，不是非做不可的事，而是想要去做的事。

```{r setup, include=F}
library(plyr)
library(tidyverse)
library(lubridate)
library(formattable)
library(knitr)
library(kableExtra)
options(knitr.kable.NA = '')

source('../scripts/common/utils.R')
```

```{r book_list, echo=F, message=F, warning=F, results = 'asis'}
output_col_names <- c(
    'ISBN',
    '书名',
    '作者',
    '买了',
    '读了',
    '读完了',
    '打个分'
)

book_list <- read_tsv(
    '../data/cn/book-list.tsv',
    col_types = 'cccccDDDi')

book_table <- function(books) {
    which_year <- books[1, ]$purchasing_year
    which_year <- gen_which_year(which_year)
    header_ <- paste0('<h2>', which_year, '</h2>')
    table_ <- books %>%
        mutate(
            purchasing_date_month_day = format_month_day(purchasing_date)) %>%
        arrange(desc(purchasing_date), author, title) %>%
        select(c('isbn', 'title', 'author', 'purchasing_date_month_day', 
                 'reading_start_date', 'reading_finish_date', 'stars')) %>%
        setNames(output_col_names) %>%
        kable("html", escape = F, table.attr = 'class="book-table"') %>%
        kable_styling(bootstrap_options = 'striped') %>%
        row_spec(0, align = 'center') %>%
        column_spec(1, extra_css = 'display: none;', include_thead = T) %>%
        column_spec(3, width = '8em') %>%
        column_spec(4, width = '3.2em') %>%
        column_spec(5, width = '5.8em') %>%
        column_spec(6, width = '5.8em') %>%
        column_spec(7, width = '7em')
    footer_ <- '<br/>'
    
    tibble(table_ = paste0(header_, table_, footer_))
}

book_list %>%
    mutate(
        title = gen_linked_text_html(title, blog_link),
        stars = gen_stars_html(rating),
        purchasing_year = year(purchasing_date)) %>%
    ddply(.(purchasing_year), book_table) %>%
    arrange(desc(purchasing_year)) %>%
    select(table_) %>%
    unlist %>%
    cat
```

<script src="/js/star-rating-svg.js"></script>
<script src="/js/star-rating-default.js"></script>
